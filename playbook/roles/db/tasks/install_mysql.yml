---
- name: Set up LANG
  lineinfile: >
    dest=/etc/sysconfig/i18n
    regexp='^LANG=.*'
    line='LANG=ja_JP.utf8'
- name: Set up timezone
  lineinfile: >
    dest=/etc/sysconfig/clock
    regexp='^ZONE=.*'
    line='ZONE="Asia/Tokyo"'
- name: Set up UTC
  lineinfile: >
    dest=/etc/sysconfig/clock
    regexp='^UTC=.*'
    line='UTC=false'
- name: Link localtime
  file: >
    src=/usr/share/zoneinfo/Asia/Tokyo
    dest=/etc/localtime
    state=link
    force=yes

- name: remove mariadb
  yum: name=mariadb-libs state=removed

- name: upgrade all packages
  yum: name=* state=latest


- name: register mysql's repository
  yum:
    name: http://dev.mysql.com/get/mysql57-community-release-el6-9.noarch.rpm
    state: present

- name: install mysql
  yum:
    name: "{{ item }}"
    enablerepo: mysql57-community
    state: present
  with_items:
    - mysql-community-server
    - mysql-community-client
    - mysql-community-common
    - mysql-community-libs
    - mysql-community-libs-compat

- name: setting mysql auto starting
  service: name=mysqld state=started enabled=yes

- name: install parckage for ansible mysql modules
  yum:
    name: "{{ item }}"
    state: latest
  with_items:
    - epel-release
    - MySQL-python
    - libselinux-python

- name: install parckage for ansible pip module
  yum:
    name: "{{ item }}"
    state: latest
  with_items:
    - python-pip
    - python-virtualenv

- name: install python module for ansible expect module
  pip: name=pexpect state=latest
